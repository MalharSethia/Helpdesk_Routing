<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <!-- Teams Section (Unchanged) -->
        <record id="internal_helpdesk_team" model="helpdesk.ticket.team">
            <field name="name">Internal Support Team</field>
            <field name="active">True</field>
        </record>
        
        <record id="external_helpdesk_team" model="helpdesk.ticket.team">
            <field name="name">External Support Team</field>
            <field name="active">True</field>
        </record>
        
        <!-- Fixed Email Template -->
        <record id="ticket_assignment_email_template" model="mail.template">
            <field name="name">Helpdesk Ticket Assignment</field>
            <field name="model_id" ref="helpdesk_mgmt.model_helpdesk_ticket"/>
            <field name="subject">New {{ 'Internal' if object.is_internal_ticket else 'External' }} Ticket: {{ object.name }}</field>
            <field name="email_to">{{ object.team_id.user_id.email }}</field>
            <field name="email_format">html</field>
            <field name="body_html"><![CDATA[
<div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
    <h2 style="color: #875A7B; border-bottom: 1px solid #eee; padding-bottom: 10px;">
        New Ticket Assignment
    </h2>
    
    <p>Hello <strong>{{ object.team_id.user_id.name }}</strong>,</p>
    
    <p>You've been assigned a new <span style="color: #875A7B; font-weight: bold;">
    {{ 'Internal' if object.is_internal_ticket else 'External' }}</span> ticket:</p>
    
    <div style="background: #f9f9f9; border-left: 4px solid #875A7B; padding: 15px; margin: 15px 0;">
        <table style="width: 100%;">
            <tr>
                <td style="width: 30%; padding: 5px; font-weight: bold;">Ticket #:</td>
                <td style="padding: 5px;">{{ object.name }}</td>
            </tr>
            <tr>
                <td style="padding: 5px; font-weight: bold;">Customer:</td>
                <td style="padding: 5px;">{{ object.partner_id.name or 'Guest' }}</td>
            </tr>
            <tr>
                <td style="padding: 5px; font-weight: bold;">Priority:</td>
                <td style="padding: 5px;">
                    <span style="color: {% if object.priority == '3' %}#e74c3c{% elif object.priority == '2' %}#f39c12{% else %}#2ecc71{% endif %};">
                        {{ object.priority }}
                    </span>
                </td>
            </tr>
        </table>
    </div>

    <div style="text-align: center; margin: 25px 0;">
        <a href="{{ object.get_base_url() }}/web#id={{ object.id }}&model=helpdesk.ticket&view_type=form" 
           style="background: #875A7B; color: white; padding: 12px 24px; text-decoration: none; 
                  border-radius: 4px; display: inline-block; font-weight: bold;">
            âž¤ Open Ticket
        </a>
    </div>

    <div style="font-size: 12px; color: #999; border-top: 1px solid #eee; padding-top: 10px;">
        <p>This is an automated notification. Please do not reply to this email.</p>
    </div>
</div>
            ]]></field>
        </record>
    </data>
</odoo>
